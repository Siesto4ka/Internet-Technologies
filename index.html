<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Tic Tac Toe</title>
	<style>
		body {
			font-family: 'Arial', sans-serif;
			text-align: center;
			margin: 50px;
		}

		h1 {
			color: #333;
		}

		button {
			font-size: 16px;
			margin: 10px;
			padding: 10px;
			cursor: pointer;
		}

		#tic-tac-toe {
			margin: 20px auto;
		}

		table {
			border-collapse: collapse;
			margin: auto;
		}

		table,
		th,
		td {
			border: 1px solid #333;
		}

		th,
		td {
			width: 50px;
			height: 50px;
			text-align: center;
			font-size: 24px;
			cursor: pointer;
		}

		th {
			background-color: #f2f2f2;
		}

		td:hover {
			background-color: #ddd;
		}

		#player-turn {
			font-size: 18px;
			margin-bottom: 10px;
		}

		.symbol-x {
			color: red;
		}

		.symbol-o {
			color: blue;
		}
	</style>
</head>

<body>

	<h1>Хрестики-нулики</h1>
	<button onclick="startGame('two_players')">Два гравці</button>
	<button onclick="startGame('one_player')">Один гравець</button>
	<p id="player-turn"></p>
	<table id="tic-tac-toe">
		<tr>
			<td onclick="makeMove(0, 0)"></td>
			<td onclick="makeMove(0, 1)"></td>
			<td onclick="makeMove(0, 2)"></td>
		</tr>
		<tr>
			<td onclick="makeMove(1, 0)"></td>
			<td onclick="makeMove(1, 1)"></td>
			<td onclick="makeMove(1, 2)"></td>
		</tr>
		<tr>
			<td onclick="makeMove(2, 0)"></td>
			<td onclick="makeMove(2, 1)"></td>
			<td onclick="makeMove(2, 2)"></td>
		</tr>
	</table>
	<button onclick="resetGame()">Скинути гру</button>

	<script>
		let currentPlayer = "X";
		let gameBoard = [
			["", "", ""],
			["", "", ""],
			["", "", ""]
		];
		let gameActive = false;
		let playerTurnElement = document.getElementById("player-turn");
		let gameMode = "";

		function startGame(mode) {
			gameMode = mode;
			gameActive = true;
			resetGame();
		}

		function makeMove(row, col) {
			if (!gameActive || gameBoard[row][col] !== "") {
				return;
			}

			gameBoard[row][col] = currentPlayer;
			let cell = document.getElementById("tic-tac-toe").rows[row].cells[col];
			cell.innerHTML = currentPlayer;
			cell.classList.add(currentPlayer === "X" ? "symbol-x" : "symbol-o");

			if (checkWin()) {
				playerTurnElement.textContent = `${currentPlayer} wins!`;
				gameActive = false;
			} else if (checkDraw()) {
				playerTurnElement.textContent = "It's a draw!";
				gameActive = false;
			} else {
				currentPlayer = currentPlayer === "X" ? "O" : "X";
				playerTurnElement.textContent = getCurrentPlayerTurn();

				if (gameMode === "one_player" && currentPlayer === "O") {
					makeBotMove();
				}
			}
		}

		function makeBotMove() {
			let bestMove = findBestMove();
			makeMove(bestMove.row, bestMove.col);
		}

		function findBestMove() {
			let bestScore = -Infinity;
			let bestMove = {};

			for (let i = 0; i < 3; i++) {
				for (let j = 0; j < 3; j++) {
					if (gameBoard[i][j] === "") {
						gameBoard[i][j] = "O";
						let score = minimax(gameBoard, 0, false);
						gameBoard[i][j] = ""; 

						if (score > bestScore) {
							bestScore = score;
							bestMove = { row: i, col: j };
						}
					}
				}
			}

			return bestMove;
		}

		function minimax(board, depth, isMaximizing) {
			if (checkWin(board)) {
				return isMaximizing ? -1 : 1;
			} else if (checkDraw(board)) {
				return 0;
			}

			if (isMaximizing) {
				let bestScore = -Infinity;
				for (let i = 0; i < 3; i++) {
					for (let j = 0; j < 3; j++) {
						if (board[i][j] === "") {
							board[i][j] = "O";
							let score = minimax(board, depth + 1, false);
							board[i][j] = ""; 
							bestScore = Math.max(score, bestScore);
						}
					}
				}
				return bestScore;
			} else {
				let bestScore = Infinity;
				for (let i = 0; i < 3; i++) {
					for (let j = 0; j < 3; j++) {
						if (board[i][j] === "") {
							board[i][j] = "X";
							let score = minimax(board, depth + 1, true);
							board[i][j] = ""; 
							bestScore = Math.min(score, bestScore);
						}
					}
				}
				return bestScore;
			}
		}

		function getCurrentPlayerTurn() {
			return `Player ${currentPlayer}'s turn`;
		}

		function checkWin(board) {
			for (let i = 0; i < 3; i++) {
				if (
					gameBoard[i][0] !== "" &&
					gameBoard[i][0] === gameBoard[i][1] &&
					gameBoard[i][1] === gameBoard[i][2]
				) {
					return true; 
				}
				if (
					gameBoard[0][i] !== "" &&
					gameBoard[0][i] === gameBoard[1][i] &&
					gameBoard[1][i] === gameBoard[2][i]
				) {
					return true; 
				}
			}

			if (
				gameBoard[0][0] !== "" &&
				gameBoard[0][0] === gameBoard[1][1] &&
				gameBoard[1][1] === gameBoard[2][2]
			) {
				return true; 
			}

			if (
				gameBoard[0][2] !== "" &&
				gameBoard[0][2] === gameBoard[1][1] &&
				gameBoard[1][1] === gameBoard[2][0]
			) {
				return true; 
			}

			return false;
		}

		function checkDraw(board) {
			 for (let row = 0; row < 3; row++) {
				for (let col = 0; col < 3; col++) {
					if (gameBoard[row][col] === "") {
						return false; 
					}
				}
			}
			return true; 
		}

		function resetGame() {
			currentPlayer = "X";
			gameBoard = [
				["", "", ""],
				["", "", ""],
				["", "", ""]
			];
			gameActive = true;
			playerTurnElement.textContent = getCurrentPlayerTurn();

			
			for (let row = 0; row < 3; row++) {
				for (let col = 0; col < 3; col++) {
					let cell = document.getElementById("tic-tac-toe").rows[row].cells[col];
					cell.innerHTML = "";
					cell.classList.remove("symbol-x", "symbol-o");
				}
			}

			if (gameMode === "one_player" && currentPlayer === "O") {
				makeBotMove();
			}
		}
	</script>

</body>

</html>