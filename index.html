<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Online Timer</title>
</head>

<body>

	<h1 id="timer">00:00:00</h1>
	<label for="durationInput">Set Timer (in seconds): </label>
	<input type="number" id="durationInput" placeholder="Enter duration">
	<button onclick="startTimer()">Start</button>
	<button onclick="pauseTimer()">Pause</button>
	<button onclick="stopTimer()">Stop</button>

	<script>
		let timerInterval;
		let timerDuration = 180; // 3 minutes in seconds
		let timerRunning = false;

		// Додаємо логіку для зчитування параметра "period" з URL
		const urlParams = new URLSearchParams(window.location.search);
		const periodParam = urlParams.get('period');
		if (periodParam) {
			const periodValue = parseInt(periodParam);
			if (!isNaN(periodValue) && periodValue > 0) {
				timerDuration = periodValue;
			}
		}

		function startTimer() {
			if (timerRunning) {
				// Якщо таймер вже працює, відновлюємо початковий стан
				clearInterval(timerInterval);
				timerRunning = false;
				timerDuration = periodParam; // або виберіть початкове значення таймера за замовчуванням
			}

			const inputElement = document.getElementById('durationInput');
			const inputValue = parseFloat(inputElement.value);
			if (!isNaN(inputValue) && inputValue > 0) {
				timerDuration = inputValue;
			}
			timerRunning = true;
			timerInterval = setInterval(updateTimer, 1000);
			updateTimer();
		}

		function pauseTimer() {
			clearInterval(timerInterval);
			timerRunning = false;
		}

		function stopTimer() {
			clearInterval(timerInterval);
			timerRunning = false;
			timerDuration = 180; // Reset duration to 3 minutes
			updateTimer();
		}

		function updateTimer() {
			const timerElement = document.getElementById('timer');
			const hours = Math.floor(timerDuration / 3600);
			const minutes = Math.floor((timerDuration % 3600) / 60);
			const seconds = timerDuration % 60;

			timerElement.textContent = `${formatTime(hours)}:${formatTime(minutes)}:${formatTime(seconds)}`;

			document.title = `${formatTime(hours)}:${formatTime(minutes)}:${formatTime(seconds)} - Online Timer`;

			if (timerDuration <= 0) {
				clearInterval(timerInterval);
				timerRunning = false;
				// Perform action after timer completion (e.g., show notification)
				showNotification('Time is up!');
				document.getElementById('timer').textContent = '00:00:00';
			} else {
				timerDuration--;
			}
		}

		function formatTime(time) {
			return time < 10 ? `0${time}` : time;
		}

		function showNotification(message) {
			if ('Notification' in window) {
				Notification.requestPermission().then(function (permission) {
					if (permission === 'granted') {
						const notification = new Notification('Online Timer', {
							body: message,
						});
					}
				});
			}
		}

	</script>

</body>

</html>